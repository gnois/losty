var rnd = require('resty.random')
var str = require('resty.string')

var K = {}

-- generate symmetric key
K.key = \secret, key ->
	return ngx.encode_base64(ngx.hmac_sha1(secret, key))


-- generate a random binary of `length` converted to hex
-- the returned string is longer than `length`
K.least = \length ->
	var key = rnd.bytes(length)
	return str.to_hex(key)

return K